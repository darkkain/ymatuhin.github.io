/* InstantClick 3.1.0 | (C) 2014 Alexandre Dieulot | http://instantclick.io/license */

/* share42.com | 28.05.2014 | (c) Dimox */

var InstantClick=function(e,t){function n(e){var t=e.indexOf("#");return 0>t?e:e.substr(0,t)}function r(e){for(;e&&"A"!=e.nodeName;)e=e.parentNode;return e}function s(e){var r=t.protocol+"//"+t.host;if(!(r=e.target||e.hasAttribute("download")||0!=e.href.indexOf(r+"/")||-1<e.href.indexOf("#")&&n(e.href)==w)){if(P){e:{do{if(!e.hasAttribute)break;if(e.hasAttribute("data-no-instant"))break;if(e.hasAttribute("data-instant")){e=!0;break e}}while(e=e.parentNode);e=!1}e=!e}else e:{do{if(!e.hasAttribute)break;if(e.hasAttribute("data-instant"))break;if(e.hasAttribute("data-no-instant")){e=!0;break e}}while(e=e.parentNode);e=!1}r=e}return r?!1:!0}function o(e,t,n,r){for(var i=!1,s=0;s<F[e].length;s++)if("receive"==e){var o=F[e][s](t,n,r);o&&("body"in o&&(n=o.body),"title"in o&&(r=o.title),i=o)}else F[e][s](t,n,r);return i}function u(t,r,i,s){e.documentElement.replaceChild(r,e.body);if(i){history.pushState(null,null,i),r=i.indexOf("#"),r=-1<r&&e.getElementById(i.substr(r+1)),s=0;if(r)for(;r.offsetParent;)s+=r.offsetTop,r=r.offsetParent;scrollTo(0,s),w=n(i)}else scrollTo(0,s);e.title=y&&e.title==t?t+String.fromCharCode(160):t,d(),I.done(),o("change",!1),t=e.createEvent("HTMLEvents"),t.initEvent("instantclick:newpage",!0,!0),dispatchEvent(t)}function a(e){x>+(new Date)-500||(e=r(e.target))&&s(e)&&v(e.href)}function f(e){x>+(new Date)-500||(e=r(e.target))&&s(e)&&(e.addEventListener("mouseout",h),B?(E=e.href,S=setTimeout(v,B)):v(e.href))}function l(e){x=+(new Date),(e=r(e.target))&&s(e)&&(H?e.removeEventListener("mousedown",a):e.removeEventListener("mouseover",f),v(e.href))}function c(e){var t=r(e.target);!t||!s(t)||1<e.which||e.metaKey||e.ctrlKey||(e.preventDefault(),m(t.href))}function h(){S?(clearTimeout(S),S=!1):M&&!_&&(N.abort(),_=M=!1)}function p(){if(!(4>N.readyState)&&0!=N.status){O.ready=+(new Date)-O.start;if(N.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=e.implementation.createHTMLDocument("");t.documentElement.innerHTML=N.responseText.replace(/<noscript[\s\S]+<\/noscript>/gi,""),k=t.title,A=t.body;var r=o("receive",C,A,k);r&&("body"in r&&(A=r.body),"title"in r&&(k=r.title)),r=n(C),T[r]={body:A,title:k,scrollY:r in T?T[r].scrollY:0};for(var t=t.head.children,r=0,i,s=t.length-1;0<=s;s--)if(i=t[s],i.hasAttribute("data-instant-track")){i=i.getAttribute("href")||i.getAttribute("src")||i.innerHTML;for(var u=D.length-1;0<=u;u--)D[u]==i&&r++}r!=D.length&&(L=!0)}else L=!0;_&&(_=!1,m(C))}}function d(t){e.body.addEventListener("touchstart",l,!0),H?e.body.addEventListener("mousedown",a,!0):e.body.addEventListener("mouseover",f,!0),e.body.addEventListener("click",c,!0);if(!t){t=e.body.getElementsByTagName("script");var n,r,s,o;i=0;for(j=t.length;i<j;i++)n=t[i],n.hasAttribute("data-no-instant")||(r=e.createElement("script"),n.src&&(r.src=n.src),n.innerHTML&&(r.innerHTML=n.innerHTML),s=n.parentNode,o=n.nextSibling,s.removeChild(n),s.insertBefore(r,o))}}function v(e){!H&&"display"in O&&100>+(new Date)-(O.start+O.display)||(S&&(clearTimeout(S),S=!1),e||(e=E),M&&(e==C||_))||(M=!0,_=!1,C=e,L=A=!1,O={start:+(new Date)},o("fetch"),N.open("GET",e),N.send())}function m(e){"display"in O||(O.display=+(new Date)-O.start),S||!M?S&&C&&C!=e?t.href=e:(v(e),I.start(0,!0),o("wait"),_=!0):_?t.href=e:L?t.href=C:A?(T[w].scrollY=pageYOffset,_=M=!1,u(k,A,C)):(I.start(0,!0),o("wait"),_=!0)}var g=navigator.userAgent,y=-1<g.indexOf(" CriOS/"),b="createTouch"in e,w,E,S,x,T={},N,C=!1,k=!1,L=!1,A=!1,O={},M=!1,_=!1,D=[],P,H,B,F={fetch:[],receive:[],wait:[],change:[]},I=function(){function t(t,s){l=t,e.getElementById(u.id)&&e.body.removeChild(u),u.style.opacity="1",e.getElementById(u.id)&&e.body.removeChild(u),i(),s&&setTimeout(n,0),clearTimeout(c),c=setTimeout(r,500)}function n(){l=10,i()}function r(){l+=1+2*Math.random(),98<=l?l=98:c=setTimeout(r,500),i()}function i(){a.style[f]="translate("+l+"%)",e.getElementById(u.id)||e.body.appendChild(u)}function s(){e.getElementById(u.id)?(clearTimeout(c),l=100,i(),u.style.opacity="0"):(t(100==l?0:l),setTimeout(s,0))}function o(){u.style.left=pageXOffset+"px",u.style.width=innerWidth+"px",u.style.top=pageYOffset+"px";var e="orientation"in window&&90==Math.abs(orientation);u.style[f]="scaleY("+innerWidth/screen[e?"height":"width"]*2+")"}var u,a,f,l,c;return{init:function(){u=e.createElement("div"),u.id="instantclick",a=e.createElement("div"),a.id="instantclick-bar",a.className="instantclick-bar",u.appendChild(a);var t=["Webkit","Moz","O"];f="transform";if(!(f in a.style))for(var n=0;3>n;n++)t[n]+"Transform"in a.style&&(f=t[n]+"Transform");var r="transition";if(!(r in a.style))for(n=0;3>n;n++)t[n]+"Transition"in a.style&&(r="-"+t[n].toLowerCase()+"-"+r);t=e.createElement("style"),t.innerHTML="#instantclick{position:"+(b?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+r+":opacity .25s .1s}.instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+r+":all .25s}",e.head.appendChild(t),b&&(o(),addEventListener("resize",o),addEventListener("scroll",o))},start:t,done:s}}(),q="pushState"in history&&(!g.match("Android")||g.match("Chrome/"))&&"file:"!=t.protocol;return{supported:q,init:function(){if(!w)if(q){for(var r=arguments.length-1;0<=r;r--){var i=arguments[r];!0===i?P=!0:"mousedown"==i?H=!0:"number"==typeof i&&(B=i)}w=n(t.href),T[w]={body:e.body,title:e.title,scrollY:pageYOffset};for(var i=e.head.children,s,r=i.length-1;0<=r;r--)s=i[r],s.hasAttribute("data-instant-track")&&(s=s.getAttribute("href")||s.getAttribute("src")||s.innerHTML,D.push(s));N=new XMLHttpRequest,N.addEventListener("readystatechange",p),d(!0),I.init(),o("change",!0),addEventListener("popstate",function(){var e=n(t.href);e!=w&&(e in T?(T[w].scrollY=pageYOffset,w=e,u(T[e].title,T[e].body,!1,T[e].scrollY)):t.href=t.href)})}else o("change",!0)},on:function(e,t){F[e].push(t)}}}(document,location);define("instantclick.min",function(){}),define("typo",[],function(){function e(e){function t(e,t){var n=document.querySelectorAll(e);for(var r=0;r<n.length;r++)t(n[r],r)}e=e||"p, ol, ul, blockquote, h1, h2, h3, h4";if(document.querySelector(".slaquo, .sbrace")!==null)return;t(e,function(e,t){e.innerHTML=e.innerHTML.replace(/«/g,'<span class="slaquo"> </span> <span class="hlaquo"> «</span>'),e.innerHTML=e.innerHTML.replace(/\(/g,'<span class="sbrace"> </span> <span class="hbrace"> (</span>')})}return{go:e}}),define("disqus",[],function(){function t(){if(!document.getElementById("disqus_thread")||e)return;e=!0;var t="ymatuhin";(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()}function n(){e||t();if(!document.getElementById("disqus_thread")||!DISQUS)return;DISQUS.reset({reload:!0,config:function(){this.page.identifier=location.pathname,this.page.url=location.href}})}var e=!1;return{init:t,reload:n}}),define("share42",[],function(){var e=function(){var e=document.getElementsByTagName("div");for(var t=0;t<e.length;t++)if(e[t].className.indexOf("share42init")!=-1){if(e[t].getAttribute("data-url")!=-1)var n=e[t].getAttribute("data-url");if(e[t].getAttribute("data-title")!=-1)var r=e[t].getAttribute("data-title");if(e[t].getAttribute("data-image")!=-1)var i=e[t].getAttribute("data-image");if(e[t].getAttribute("data-description")!=-1)var s=e[t].getAttribute("data-description");if(e[t].getAttribute("data-path")!=-1)var o=e[t].getAttribute("data-path");if(e[t].getAttribute("data-icons-file")!=-1)var u=e[t].getAttribute("data-icons-file");if(!o){function a(e){var t=document.getElementsByTagName("script"),n=new RegExp("^(.*/|)("+e+")([#?]|$)");for(var r=0,i=t.length;r<i;r++){var s=String(t[r].src).match(n);if(s)return s[1].match(/^((https?|file)\:\/{2,}|\w:[\/\\])/)?s[1]:s[1].indexOf("/")==0?s[1]:(b=document.getElementsByTagName("base"),b[0]&&b[0].href?b[0].href+s[1]:document.location.pathname.match(/(.*[\/\\])/)[0]+s[1])}return null}o=a("share42.js")}n||(n=location.href),r||(r=document.title),u||(u="icons.png");function f(){var e=document.getElementsByTagName("meta");for(var t=0;t<e.length;t++)if(e[t].name.toLowerCase()=="description")return e[t].content;return""}s||(s=f()),n=encodeURIComponent(n),r=encodeURIComponent(r),r=r.replace(/\'/g,"%27"),i=encodeURIComponent(i),s=encodeURIComponent(s),s=s.replace(/\'/g,"%27");var l="u="+n;i!="null"&&i!=""&&(l="s=100&p[url]="+n+"&p[title]="+r+"&p[summary]="+s+"&p[images][0]="+i);var c="";i!="null"&&i!=""&&(c="&image="+i);var h=new Array('"#" data-count="vk" onclick="window.open(\'http://vk.com/share.php?url='+n+"&title="+r+c+"&description="+s+"', '_blank', 'scrollbars=0, resizable=1, menubar=0, left=100, top=100, width=550, height=440, toolbar=0, status=0');return false\" title=\"Поделиться В Контакте\"",'"#" data-count="fb" onclick="window.open(\'http://www.facebook.com/sharer.php?m2w&'+l+"', '_blank', 'scrollbars=0, resizable=1, menubar=0, left=100, top=100, width=550, height=440, toolbar=0, status=0');return false\" title=\"Поделиться в Facebook\"",'"#" data-count="twi" onclick="window.open(\'https://twitter.com/intent/tweet?text='+r+"&url="+n+"', '_blank', 'scrollbars=0, resizable=1, menubar=0, left=100, top=100, width=550, height=440, toolbar=0, status=0');return false\" title=\"Добавить в Twitter\"",'"#" data-count="lnkd" onclick="window.open(\'http://www.linkedin.com/shareArticle?mini=true&url='+n+"&title="+r+"', '_blank', 'scrollbars=0, resizable=1, menubar=0, left=100, top=100, width=600, height=400, toolbar=0, status=0');return false\" title=\"Добавить в Linkedin\"",'"#" data-count="gplus" onclick="window.open(\'https://plus.google.com/share?url='+n+"', '_blank', 'scrollbars=0, resizable=1, menubar=0, left=100, top=100, width=550, height=440, toolbar=0, status=0');return false\" title=\"Поделиться в Google+\"",'"https://www.evernote.com/clip.action?url='+n+"&title="+r+'" title="Добавить в Evernote"','"http://ymatuhin.ru/feed.xml" title="Подписаться на RSS сайта"'),p="";for(j=0;j<h.length;j++)p+='<a rel="nofollow" style="display:inline-block;vertical-align:bottom;width:24px;height:24px;margin:0 6px 6px 0;padding:0;outline:none;background:url('+o+u+") -"+24*j+'px 0 no-repeat" href='+h[j]+' target="_blank"></a>';e[t].innerHTML='<span id="share42">'+p+"</span>"}};return{init:e}}),define("yaMetrica",["http://mc.yandex.ru/metrika/watch.js"],function(){function e(){try{window.yaCounter28017147=new Ya.Metrika({id:28017147,webvisor:!0,clickmap:!0})}catch(e){}}return{init:e}}),define("cssLoader",[],function(){function e(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}return{load:e}}),requirejs.config({baseUrl:"/js/",paths:{}}),require(["instantclick.min","typo","disqus","share42"],function(e,t,n,r){function i(){t.go(),r.init();try{window.yaCounter28017147.hit(location.href)}catch(e){}try{window.pluso.refreshCounter(location.href)}catch(e){}setTimeout(n.reload,1e3)}InstantClick.init(),InstantClick.on("change",i),t.go(),n.init(),r.init()}),~location.href.indexOf("//localhost:4000")||require(["yaMetrica"],function(e){e.init()}),require(["cssLoader"],function(e){e.load("/css/secondary.css")}),define("main",function(){});